{%extends 'website_layout.html'%}
{%load static%}
{% block content%}
<style>
    .register .nav-tabs{
    margin-bottom: 3%;
    border: none;
    background: #0b818b;
    border-radius: 1.5rem;
}
.register .nav-tabs .nav-link{
    padding-top: 2%;
    padding-bottom: 2%;
    height: 34px;
    font-weight: 600;
    color: #fff;
    border-top-right-radius: 1.5rem;
    border-bottom-right-radius: 1.5rem;
}
.register .nav-tabs .nav-item a:hover{
    border: none;
    color:#0b818b
}
.register .nav-tabs .nav-item.active a{
    width: 100px;
    color: #0b818b;
    border: 2px solid #0b818b;
    border-top-left-radius: 1.5rem;
    border-bottom-left-radius: 1.5rem;
    background-color: #fff;
}.breadcrumb-outer span{
    float: right;
    position: relative;
    top: -34px}
</style>
<section class="breadcrumb">
    <div class="container">
    <div class="breadcrumb-outer">
    <nav aria-label="breadcrumb">
    <ul class="breadcrumb">
    <li class="breadcrumb-item"><a href="{% url 'website:index'%}">Home</a></li>
    <li class="breadcrumb-item active" aria-current="page">Login</li>
    </ul>
    </nav>
    <h2>Register</h2>
    <span class="register">
            <ul class="nav nav-tabs" id="myTab" role="tablist">
                    <li id="Patient" class="nav-item">
                        <a class="nav-link" id="home-tab" href="/PatientRegistration" role="tab" aria-controls="home" aria-selected="true">Patient</a>
                    </li>
                    <li id="Doctor" class="nav-item active">
                        <a class="nav-link" id="profile-tab" href="#" role="tab" aria-controls="profile" aria-selected="false">Doctor</a>
                    </li>
                </ul>
     
    </span>
    </div>
    </div>
    </section>
    <section class="login">
<div class="container">
<div class="row" >
<div class="col-md-12 col-sm-12 col-xs-12">
<div class="login-form" style="padding: 0 10%;">
 <div class="col-xs-12">
    <div class="form-title" style="text-align: justify;padding: 20px 17%;margin-bottom: 0"><br>
    <p>Dear Doctor, </p><br>
    <p>Kindly spare a few minutes to register yourself on our platform. We have a
vast database of patients who need your care and expertise. </p><br>
   <p>Once we receive your basic details you will be sent an MOU on which we
require your signature and seal after which we can start consulting
immediately</p><br>
   <p>We request your support and cooperation in this regard to make our patient
outreach program a success.</p><br>
   <p><b>Basic Contact Information</b></p>
    </div>
    </div>
  <form style="padding: 30px 20%;" id="doctorRegistration">
    <div class="row">
    <div class="">
    <div class="form-group col-xs-12">
    <input type="text" placeholder="Name" name="full_name" required id="Name1">
    </div>
    <div class="form-group col-xs-12">
    <input type="text" placeholder="Medical ID" name="Registration_number" required>
    </div>
    <div class="form-group col-xs-12">
        <select id="select-specialist" name="specialist_type" required>
            <option value="Speciality">Speciality</option>
            <option value="General Physician">General Physician</option>
            <option value="Dermatologist">Dermatologist</option>
            <option value="Pediatrician">Pediatrician</option>
            <option value="Dietitian">Dietitian</option>
            <option value="Psychologist">Psychologist</option>
            <option value="Gynaecologist">Gynaecologist</option>
        </select>
    </div>
    <div class="form-group col-xs-10">
    <input type="tel" placeholder="Phone" name="phone_number" id="mob1">
    </div>
    <div class="form-group col-xs-2 otp">
        <p><button type="button" class="btn form-control" style="font-size:14px" id="btnOTP">Verify</button></p>
    </div>
    <div class="form-group col-xs-12" id="div-otp" style="display: none;">

        <input type="text" class="form-control"  id="OTP" placeholder="Enter the OTP" required>
        </div>
    <div class="form-group col-xs-12">
    <input type="email" placeholder="Email ID" name="email">
    </div>
    <div class="form-group col-xs-12">
    <input type="text" placeholder="City" name="city">
    </div>
    <div class="form-group col-xs-12">
    <input type="password" placeholder="Set Password" name="password">
    </div>
    <div class="form-group col-xs-12">
    <input type="password" placeholder="Re enter Password">
    </div>
    </div>
    <div class="">
    <div class="col-xs-12">
    <div class="form-btn" style="text-align: center;">
      <button type="submit" class="btn btn-block">Register me!</button>
    </div>
    </div>
    </div>
    
    </div>
    </form>
</div>
</div>
</div>
</div>
</section>
    
 

{%endblock%}

{% block scripts %}
<script type="text/javascript">
    $('#btnOTP').click(function () {
        if ($('#Name1').val() == '' || $('#mob1').val() == '')
            alert('Enter Name and Mobile Number')
        else {
            $.ajax({
                url: `https://teleduce.in/sendsms/?key=a224db72-cafb-4cce-93ab-3d7f950c92e2&text=Welcome ${$('#Name1').val()}! Your OTP for your Phone Number Verification at Doctor Plus is <OTP>&route=0&from=BANDSS&to=${$('#mob1').val()}&otp=1&otp_length=4`,
                method: 'GET',
                success: function (response) {
                    console.log(response)
                    $('#div-otp').show()
                }
            })

        }

    })

    $("#doctorRegistration").submit((e) => {
        e.preventDefault();
        e.stopImmediatePropagation();

        if ($('#OTP').val() == '') {
            alert('Enter The OTP')
            return
        }
        $.ajax({
            url: 'https://teleduce.corefactors.in/validate-otp/a224db72-cafb-4cce-93ab-3d7f950c92e2/',
            data: {
                mobile: $('#mob1').val(),
                otp: $('#OTP').val()
            }
        }).done(function (response) {
            console.log(response)
            if (response.response_code != "8000") {
                alert('Invalid OTP Please Check the OTP and Try Again')
                $('#submit').html('Register')
                $('#submit').removeAttr('disabled')
                return
            }

            $.ajax({
                url: '/api/GenerateDoctorID',
                method: 'GET',
                contentType: 'application/json'
            }).done((response) => {
                console.log("response ", response);

                let form = document.getElementById("doctorRegistration");
                let formdata = new FormData(form);
                formdata.append('username', response.doctorId);
                formdata.append('web_registration', true);
                formdata.append('gender', 'Male')
                formdata.append('about', "Nothing sppecial")
                $.ajax({
                    url: '/api/NewDoctorRegistration',
                    method: 'POST',
                    data: formdata,
                    contentType: false,
                    processData: false,
                }).done((response) => {
                    alert('Thank you !! Doctors registration process is under way, We shall get back to you shortly.');
                    $('#doctorRegistration').trigger('reset');
                    setTimeout(function () {
                        window.location.href = '/media/DoctorsAgreement.pdf'
                    }, 2000)
                }).fail((error) => {
                    console.log(error);
                })
            })
        })





    })
</script>
{% endblock %}